---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

First, we are gonna set our constants and check if the working directory exists. Then we'll set our working environment.
```{r setwd, echo = TRUE}
#Here, you can change the working directory
MAIN_DIRECTORY <- "C:/Project1ReproducibleResearch";
DATA_URL <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip";
DATA_ZIP_FILE <- "activity.zip";
DATA_UNZIP_DIRECTORY <- "activity_data";
DATA_FILE <- "activity.csv";

#Verifying if main directory exists.
if(!file.exists(MAIN_DIRECTORY)){ dir.create(MAIN_DIRECTORY); }
setwd(MAIN_DIRECTORY);
```

Then we'll download the data and then load the data into dataframe.
```{r load, echo = TRUE}
#Verifying if data file exists.
if(!file.exists(DATA_ZIP_FILE)){
  download.file(DATA_URL, DATA_ZIP_FILE);
}
#Verifying if directory exists.
if(!file.exists(DATA_UNZIP_DIRECTORY)){
  unzip(DATA_ZIP_FILE, exdir = DATA_UNZIP_DIRECTORY);
}

#Read csv data
activity_data <- read.csv(file.path(DATA_UNZIP_DIRECTORY, DATA_FILE));

#Cast the date attribute
activity_data$date <- as.Date(activity_data$date);
```

Let's show how the data looks like
```{r show, echo = TRUE}
head(activity_data);
```

## What is mean total number of steps taken per day?
We want to figure out how many steps take a person per day. Our analysis will sum the steps by date, and then we'll find the mean and the median of the data. 
```{r, echo=FALSE}
library(ggplot2);
```

Let's plot a histogram for steps by day.
```{r histogram, echo = TRUE}
#Sum all steps by date
aggregated_data <- aggregate(steps~date, activity_data, sum);

#Plotting the histogram
g <- ggplot(aggregated_data, aes(x=steps));
g  + geom_histogram(binwidth=2500, colour="black", fill="red", alpha = .4);
```

With the previous histogram we can see that usually a person registers about 10000 steps each day.

Now, we'll show you the mean and the median of steps taken per day.
```{r mean_median}
#Mean calculation
mean(aggregated_data$steps);

#Median calculation
median(aggregated_data$steps);
```
With the previous calcultation we can confirm that a person registers about 10000 steps by day with this data set.


## What is the average daily activity pattern?

Now, we want figure out how is the activity pattern across the day. And which interval has the max number of steps.

Let's plot the activity patern over a timeline
```{r serie}
#Getting the meaning of steps by interval
aggregated_data <- aggregate(steps~interval, activity_data, mean);

#Plotting the timeline
g <- ggplot(aggregated_data, aes(x = interval, y = steps));
g + geom_line(colour="darkblue") +
  #Vertical line to see the max
  geom_vline(xintercept = aggregated_data[which.max(aggregated_data$steps),]$interval, colour = "red");
```

We can see that the vertical line show us that the max number of steps is almost on 800. We can confirm it:
```{r maxsteps}
aggregated_data[which.max(aggregated_data$steps),];
```

We can see that the max number of steps is about 206, and that occur on interval 835.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
